<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>简单局域网聊天</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="chat-container">
    <!-- 侧边栏 -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2>💬 聊天</h2>
        <button class="btn-icon" id="logoutBtn" title="登出">🚪</button>
      </div>

      <div class="user-info">
        <div class="user-avatar">👤</div>
        <div class="user-details">
          <div class="user-name" id="currentUserName">加载中...</div>
          <div class="user-status online">在线</div>
        </div>
        <button class="btn-icon" id="settingsBtn" title="设置">⚙️</button>
      </div>

      <!-- 房间列表 -->
      <div class="section-title">房间</div>
      <div class="room-list" id="roomList">
        <!-- 动态加载 -->
      </div>

      <!-- 在线用户 -->
      <div class="section-title">
        在线用户
        <button class="btn-refresh" id="refreshUsers" title="刷新">🔄</button>
      </div>
      <div class="user-list" id="userList">
        <!-- 动态加载 -->
      </div>
    </div>

    <!-- 主聊天区域 -->
    <div class="main-chat">
      <!-- 聊天头部 -->
      <div class="chat-header">
        <button class="btn-menu" id="toggleSidebar">☰</button>
        <div class="chat-title">
          <h3 id="currentRoomName">选择一个房间开始聊天</h3>
          <div class="chat-subtitle" id="roomSubtitle"></div>
        </div>
        <button class="btn-icon" id="searchBtn" title="搜索消息">🔍</button>
      </div>

      <!-- 搜索栏 (隐藏) -->
      <div class="search-bar hidden" id="searchBar">
        <input type="text" id="searchInput" placeholder="搜索消息...">
        <button id="closeSearch">✕</button>
      </div>

      <!-- 搜索结果 -->
      <div class="search-results hidden" id="searchResults">
        <!-- 动态加载 -->
      </div>

      <!-- 消息列表 -->
      <div class="message-list" id="messageList">
        <div class="welcome-message">
          <h2>👋 欢迎来到简单局域网聊天</h2>
          <p>选择左侧的房间开始聊天，或点击用户发起私聊</p>
        </div>
      </div>

      <!-- 输入区域 -->
      <div class="input-area" id="inputArea" style="display: none;">
        <textarea
          id="messageInput"
          placeholder="输入消息... (Enter 发送, Shift+Enter 换行)"
          rows="1"
        ></textarea>
        <button id="sendBtn" class="btn-send" title="发送">📤</button>
      </div>
    </div>
  </div>

  <!-- 连接状态指示器 -->
  <div class="connection-status" id="connectionStatus">
    <span class="status-dot"></span>
    <span class="status-text">连接中...</span>
  </div>

  <!-- 修改密码模态框 -->
  <div class="modal" id="changePasswordModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>修改密码</h3>
        <button class="modal-close" id="closePasswordModal">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="currentPassword">当前密码</label>
          <input type="password" id="currentPassword" placeholder="输入当前密码" autocomplete="current-password">
        </div>
        <div class="form-group">
          <label for="newPassword">新密码</label>
          <input type="password" id="newPassword" placeholder="输入新密码（至少6位）" autocomplete="new-password">
        </div>
        <div class="form-group">
          <label for="confirmPassword">确认新密码</label>
          <input type="password" id="confirmPassword" placeholder="再次输入新密码" autocomplete="new-password">
        </div>
        <div class="error-message" id="passwordError"></div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="cancelPasswordChange">取消</button>
        <button class="btn-primary" id="confirmPasswordChange">确认修改</button>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>
